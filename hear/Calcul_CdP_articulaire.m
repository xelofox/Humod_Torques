file='1.2.mat';
load(file);

q=motion.trajectory.q;

CPR=zeros(3,length(q));
CPL=zeros(3,length(q));

for k=1:length(q)
    t=num2cell(transpose([q(:,k)]));
    [pBJX pBJY pBJZ rBJX rBJY rBJZ rLNJX rLNJY rLNJZ rSJX_L rSJY_L rSJZ_L rSJX_R rSJY_R rSJZ_R rEJZ_L rEJZ_R rULJX rULJY rULJZ rLLJX rLLJZ rHJX_L rHJY_L rHJZ_L rHJX_R rHJY_R rHJZ_R rKJZ_L rKJZ_R rAJX_L rAJY_L rAJZ_L rAJX_R rAJY_R rAJZ_R]=deal(t{:});
    
    R_footR0=[ - (cos(rAJX_R)*sin(rAJZ_R) - cos(rAJZ_R)*sin(rAJX_R)*sin(rAJY_R))*(cos(rKJZ_R)*(sin(rBJY)*(cos(rHJZ_R)*sin(rHJX_R) - cos(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) + cos(rBJY)*sin(rBJZ)*(cos(rHJX_R)*cos(rHJZ_R) + sin(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) + cos(rBJY)*cos(rBJZ)*cos(rHJY_R)*sin(rHJZ_R)) - sin(rKJZ_R)*(sin(rBJY)*(sin(rHJX_R)*sin(rHJZ_R) + cos(rHJX_R)*cos(rHJZ_R)*sin(rHJY_R)) + cos(rBJY)*sin(rBJZ)*(cos(rHJX_R)*sin(rHJZ_R) - cos(rHJZ_R)*sin(rHJX_R)*sin(rHJY_R)) - cos(rBJY)*cos(rBJZ)*cos(rHJY_R)*cos(rHJZ_R))) - (sin(rAJX_R)*sin(rAJZ_R) + cos(rAJX_R)*cos(rAJZ_R)*sin(rAJY_R))*(cos(rBJY)*cos(rBJZ)*sin(rHJY_R) + cos(rHJX_R)*cos(rHJY_R)*sin(rBJY) - cos(rBJY)*cos(rHJY_R)*sin(rBJZ)*sin(rHJX_R)) - cos(rAJY_R)*cos(rAJZ_R)*(cos(rKJZ_R)*(sin(rBJY)*(sin(rHJX_R)*sin(rHJZ_R) + cos(rHJX_R)*cos(rHJZ_R)*sin(rHJY_R)) + cos(rBJY)*sin(rBJZ)*(cos(rHJX_R)*sin(rHJZ_R) - cos(rHJZ_R)*sin(rHJX_R)*sin(rHJY_R)) - cos(rBJY)*cos(rBJZ)*cos(rHJY_R)*cos(rHJZ_R)) + sin(rKJZ_R)*(sin(rBJY)*(cos(rHJZ_R)*sin(rHJX_R) - cos(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) + cos(rBJY)*sin(rBJZ)*(cos(rHJX_R)*cos(rHJZ_R) + sin(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) + cos(rBJY)*cos(rBJZ)*cos(rHJY_R)*sin(rHJZ_R))),   (sin(rAJX_R)*sin(rAJZ_R) + cos(rAJX_R)*cos(rAJZ_R)*sin(rAJY_R))*(sin(rHJY_R)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) + cos(rHJY_R)*sin(rHJX_R)*(cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ)) + cos(rBJY)*cos(rHJX_R)*cos(rHJY_R)*sin(rBJX)) + (cos(rAJX_R)*sin(rAJZ_R) - cos(rAJZ_R)*sin(rAJX_R)*sin(rAJY_R))*(cos(rKJZ_R)*(cos(rHJY_R)*sin(rHJZ_R)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) - (cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_R)*cos(rHJZ_R) + sin(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) + cos(rBJY)*sin(rBJX)*(cos(rHJZ_R)*sin(rHJX_R) - cos(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R))) + sin(rKJZ_R)*((cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_R)*sin(rHJZ_R) - cos(rHJZ_R)*sin(rHJX_R)*sin(rHJY_R)) + cos(rHJY_R)*cos(rHJZ_R)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) - cos(rBJY)*sin(rBJX)*(sin(rHJX_R)*sin(rHJZ_R) + cos(rHJX_R)*cos(rHJZ_R)*sin(rHJY_R)))) - cos(rAJY_R)*cos(rAJZ_R)*(cos(rKJZ_R)*((cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_R)*sin(rHJZ_R) - cos(rHJZ_R)*sin(rHJX_R)*sin(rHJY_R)) + cos(rHJY_R)*cos(rHJZ_R)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) - cos(rBJY)*sin(rBJX)*(sin(rHJX_R)*sin(rHJZ_R) + cos(rHJX_R)*cos(rHJZ_R)*sin(rHJY_R))) - sin(rKJZ_R)*(cos(rHJY_R)*sin(rHJZ_R)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) - (cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_R)*cos(rHJZ_R) + sin(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) + cos(rBJY)*sin(rBJX)*(cos(rHJZ_R)*sin(rHJX_R) - cos(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)))), cos(rAJY_R)*cos(rAJZ_R)*(sin(rKJZ_R)*((cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_R)*cos(rHJZ_R) + sin(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) + cos(rBJX)*cos(rBJY)*(cos(rHJZ_R)*sin(rHJX_R) - cos(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) - cos(rHJY_R)*sin(rHJZ_R)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY))) + cos(rKJZ_R)*((cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_R)*sin(rHJZ_R) - cos(rHJZ_R)*sin(rHJX_R)*sin(rHJY_R)) + cos(rHJY_R)*cos(rHJZ_R)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY)) + cos(rBJX)*cos(rBJY)*(sin(rHJX_R)*sin(rHJZ_R) + cos(rHJX_R)*cos(rHJZ_R)*sin(rHJY_R)))) - (sin(rAJX_R)*sin(rAJZ_R) + cos(rAJX_R)*cos(rAJZ_R)*sin(rAJY_R))*(sin(rHJY_R)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY)) + cos(rHJY_R)*sin(rHJX_R)*(cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ)) - cos(rBJX)*cos(rBJY)*cos(rHJX_R)*cos(rHJY_R)) - (sin(rKJZ_R)*((cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_R)*sin(rHJZ_R) - cos(rHJZ_R)*sin(rHJX_R)*sin(rHJY_R)) + cos(rHJY_R)*cos(rHJZ_R)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY)) + cos(rBJX)*cos(rBJY)*(sin(rHJX_R)*sin(rHJZ_R) + cos(rHJX_R)*cos(rHJZ_R)*sin(rHJY_R))) - cos(rKJZ_R)*((cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_R)*cos(rHJZ_R) + sin(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) + cos(rBJX)*cos(rBJY)*(cos(rHJZ_R)*sin(rHJX_R) - cos(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) - cos(rHJY_R)*sin(rHJZ_R)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY))))*(cos(rAJX_R)*sin(rAJZ_R) - cos(rAJZ_R)*sin(rAJX_R)*sin(rAJY_R));
       (cos(rAJX_R)*cos(rAJZ_R) + sin(rAJX_R)*sin(rAJY_R)*sin(rAJZ_R))*(cos(rKJZ_R)*(sin(rBJY)*(cos(rHJZ_R)*sin(rHJX_R) - cos(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) + cos(rBJY)*sin(rBJZ)*(cos(rHJX_R)*cos(rHJZ_R) + sin(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) + cos(rBJY)*cos(rBJZ)*cos(rHJY_R)*sin(rHJZ_R)) - sin(rKJZ_R)*(sin(rBJY)*(sin(rHJX_R)*sin(rHJZ_R) + cos(rHJX_R)*cos(rHJZ_R)*sin(rHJY_R)) + cos(rBJY)*sin(rBJZ)*(cos(rHJX_R)*sin(rHJZ_R) - cos(rHJZ_R)*sin(rHJX_R)*sin(rHJY_R)) - cos(rBJY)*cos(rBJZ)*cos(rHJY_R)*cos(rHJZ_R))) + (cos(rAJZ_R)*sin(rAJX_R) - cos(rAJX_R)*sin(rAJY_R)*sin(rAJZ_R))*(cos(rBJY)*cos(rBJZ)*sin(rHJY_R) + cos(rHJX_R)*cos(rHJY_R)*sin(rBJY) - cos(rBJY)*cos(rHJY_R)*sin(rBJZ)*sin(rHJX_R)) - cos(rAJY_R)*sin(rAJZ_R)*(cos(rKJZ_R)*(sin(rBJY)*(sin(rHJX_R)*sin(rHJZ_R) + cos(rHJX_R)*cos(rHJZ_R)*sin(rHJY_R)) + cos(rBJY)*sin(rBJZ)*(cos(rHJX_R)*sin(rHJZ_R) - cos(rHJZ_R)*sin(rHJX_R)*sin(rHJY_R)) - cos(rBJY)*cos(rBJZ)*cos(rHJY_R)*cos(rHJZ_R)) + sin(rKJZ_R)*(sin(rBJY)*(cos(rHJZ_R)*sin(rHJX_R) - cos(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) + cos(rBJY)*sin(rBJZ)*(cos(rHJX_R)*cos(rHJZ_R) + sin(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) + cos(rBJY)*cos(rBJZ)*cos(rHJY_R)*sin(rHJZ_R))), - (cos(rAJZ_R)*sin(rAJX_R) - cos(rAJX_R)*sin(rAJY_R)*sin(rAJZ_R))*(sin(rHJY_R)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) + cos(rHJY_R)*sin(rHJX_R)*(cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ)) + cos(rBJY)*cos(rHJX_R)*cos(rHJY_R)*sin(rBJX)) - (cos(rAJX_R)*cos(rAJZ_R) + sin(rAJX_R)*sin(rAJY_R)*sin(rAJZ_R))*(cos(rKJZ_R)*(cos(rHJY_R)*sin(rHJZ_R)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) - (cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_R)*cos(rHJZ_R) + sin(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) + cos(rBJY)*sin(rBJX)*(cos(rHJZ_R)*sin(rHJX_R) - cos(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R))) + sin(rKJZ_R)*((cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_R)*sin(rHJZ_R) - cos(rHJZ_R)*sin(rHJX_R)*sin(rHJY_R)) + cos(rHJY_R)*cos(rHJZ_R)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) - cos(rBJY)*sin(rBJX)*(sin(rHJX_R)*sin(rHJZ_R) + cos(rHJX_R)*cos(rHJZ_R)*sin(rHJY_R)))) - cos(rAJY_R)*sin(rAJZ_R)*(cos(rKJZ_R)*((cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_R)*sin(rHJZ_R) - cos(rHJZ_R)*sin(rHJX_R)*sin(rHJY_R)) + cos(rHJY_R)*cos(rHJZ_R)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) - cos(rBJY)*sin(rBJX)*(sin(rHJX_R)*sin(rHJZ_R) + cos(rHJX_R)*cos(rHJZ_R)*sin(rHJY_R))) - sin(rKJZ_R)*(cos(rHJY_R)*sin(rHJZ_R)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) - (cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_R)*cos(rHJZ_R) + sin(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) + cos(rBJY)*sin(rBJX)*(cos(rHJZ_R)*sin(rHJX_R) - cos(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)))), (sin(rKJZ_R)*((cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_R)*sin(rHJZ_R) - cos(rHJZ_R)*sin(rHJX_R)*sin(rHJY_R)) + cos(rHJY_R)*cos(rHJZ_R)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY)) + cos(rBJX)*cos(rBJY)*(sin(rHJX_R)*sin(rHJZ_R) + cos(rHJX_R)*cos(rHJZ_R)*sin(rHJY_R))) - cos(rKJZ_R)*((cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_R)*cos(rHJZ_R) + sin(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) + cos(rBJX)*cos(rBJY)*(cos(rHJZ_R)*sin(rHJX_R) - cos(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) - cos(rHJY_R)*sin(rHJZ_R)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY))))*(cos(rAJX_R)*cos(rAJZ_R) + sin(rAJX_R)*sin(rAJY_R)*sin(rAJZ_R)) + (cos(rAJZ_R)*sin(rAJX_R) - cos(rAJX_R)*sin(rAJY_R)*sin(rAJZ_R))*(sin(rHJY_R)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY)) + cos(rHJY_R)*sin(rHJX_R)*(cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ)) - cos(rBJX)*cos(rBJY)*cos(rHJX_R)*cos(rHJY_R)) + cos(rAJY_R)*sin(rAJZ_R)*(sin(rKJZ_R)*((cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_R)*cos(rHJZ_R) + sin(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) + cos(rBJX)*cos(rBJY)*(cos(rHJZ_R)*sin(rHJX_R) - cos(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) - cos(rHJY_R)*sin(rHJZ_R)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY))) + cos(rKJZ_R)*((cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_R)*sin(rHJZ_R) - cos(rHJZ_R)*sin(rHJX_R)*sin(rHJY_R)) + cos(rHJY_R)*cos(rHJZ_R)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY)) + cos(rBJX)*cos(rBJY)*(sin(rHJX_R)*sin(rHJZ_R) + cos(rHJX_R)*cos(rHJZ_R)*sin(rHJY_R))));
                                                                                                   sin(rAJY_R)*(cos(rKJZ_R)*(sin(rBJY)*(sin(rHJX_R)*sin(rHJZ_R) + cos(rHJX_R)*cos(rHJZ_R)*sin(rHJY_R)) + cos(rBJY)*sin(rBJZ)*(cos(rHJX_R)*sin(rHJZ_R) - cos(rHJZ_R)*sin(rHJX_R)*sin(rHJY_R)) - cos(rBJY)*cos(rBJZ)*cos(rHJY_R)*cos(rHJZ_R)) + sin(rKJZ_R)*(sin(rBJY)*(cos(rHJZ_R)*sin(rHJX_R) - cos(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) + cos(rBJY)*sin(rBJZ)*(cos(rHJX_R)*cos(rHJZ_R) + sin(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) + cos(rBJY)*cos(rBJZ)*cos(rHJY_R)*sin(rHJZ_R))) - cos(rAJX_R)*cos(rAJY_R)*(cos(rBJY)*cos(rBJZ)*sin(rHJY_R) + cos(rHJX_R)*cos(rHJY_R)*sin(rBJY) - cos(rBJY)*cos(rHJY_R)*sin(rBJZ)*sin(rHJX_R)) + cos(rAJY_R)*sin(rAJX_R)*(cos(rKJZ_R)*(sin(rBJY)*(cos(rHJZ_R)*sin(rHJX_R) - cos(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) + cos(rBJY)*sin(rBJZ)*(cos(rHJX_R)*cos(rHJZ_R) + sin(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) + cos(rBJY)*cos(rBJZ)*cos(rHJY_R)*sin(rHJZ_R)) - sin(rKJZ_R)*(sin(rBJY)*(sin(rHJX_R)*sin(rHJZ_R) + cos(rHJX_R)*cos(rHJZ_R)*sin(rHJY_R)) + cos(rBJY)*sin(rBJZ)*(cos(rHJX_R)*sin(rHJZ_R) - cos(rHJZ_R)*sin(rHJX_R)*sin(rHJY_R)) - cos(rBJY)*cos(rBJZ)*cos(rHJY_R)*cos(rHJZ_R))),                                                                                               sin(rAJY_R)*(cos(rKJZ_R)*((cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_R)*sin(rHJZ_R) - cos(rHJZ_R)*sin(rHJX_R)*sin(rHJY_R)) + cos(rHJY_R)*cos(rHJZ_R)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) - cos(rBJY)*sin(rBJX)*(sin(rHJX_R)*sin(rHJZ_R) + cos(rHJX_R)*cos(rHJZ_R)*sin(rHJY_R))) - sin(rKJZ_R)*(cos(rHJY_R)*sin(rHJZ_R)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) - (cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_R)*cos(rHJZ_R) + sin(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) + cos(rBJY)*sin(rBJX)*(cos(rHJZ_R)*sin(rHJX_R) - cos(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)))) + cos(rAJX_R)*cos(rAJY_R)*(sin(rHJY_R)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) + cos(rHJY_R)*sin(rHJX_R)*(cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ)) + cos(rBJY)*cos(rHJX_R)*cos(rHJY_R)*sin(rBJX)) - cos(rAJY_R)*sin(rAJX_R)*(cos(rKJZ_R)*(cos(rHJY_R)*sin(rHJZ_R)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) - (cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_R)*cos(rHJZ_R) + sin(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) + cos(rBJY)*sin(rBJX)*(cos(rHJZ_R)*sin(rHJX_R) - cos(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R))) + sin(rKJZ_R)*((cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_R)*sin(rHJZ_R) - cos(rHJZ_R)*sin(rHJX_R)*sin(rHJY_R)) + cos(rHJY_R)*cos(rHJZ_R)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) - cos(rBJY)*sin(rBJX)*(sin(rHJX_R)*sin(rHJZ_R) + cos(rHJX_R)*cos(rHJZ_R)*sin(rHJY_R)))),                                                                                             cos(rAJY_R)*sin(rAJX_R)*(sin(rKJZ_R)*((cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_R)*sin(rHJZ_R) - cos(rHJZ_R)*sin(rHJX_R)*sin(rHJY_R)) + cos(rHJY_R)*cos(rHJZ_R)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY)) + cos(rBJX)*cos(rBJY)*(sin(rHJX_R)*sin(rHJZ_R) + cos(rHJX_R)*cos(rHJZ_R)*sin(rHJY_R))) - cos(rKJZ_R)*((cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_R)*cos(rHJZ_R) + sin(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) + cos(rBJX)*cos(rBJY)*(cos(rHJZ_R)*sin(rHJX_R) - cos(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) - cos(rHJY_R)*sin(rHJZ_R)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY)))) - cos(rAJX_R)*cos(rAJY_R)*(sin(rHJY_R)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY)) + cos(rHJY_R)*sin(rHJX_R)*(cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ)) - cos(rBJX)*cos(rBJY)*cos(rHJX_R)*cos(rHJY_R)) - sin(rAJY_R)*(sin(rKJZ_R)*((cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_R)*cos(rHJZ_R) + sin(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) + cos(rBJX)*cos(rBJY)*(cos(rHJZ_R)*sin(rHJX_R) - cos(rHJX_R)*sin(rHJY_R)*sin(rHJZ_R)) - cos(rHJY_R)*sin(rHJZ_R)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY))) + cos(rKJZ_R)*((cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_R)*sin(rHJZ_R) - cos(rHJZ_R)*sin(rHJX_R)*sin(rHJY_R)) + cos(rHJY_R)*cos(rHJZ_R)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY)) + cos(rBJX)*cos(rBJY)*(sin(rHJX_R)*sin(rHJZ_R) + cos(rHJX_R)*cos(rHJZ_R)*sin(rHJY_R))))];
 
    R_footL0=[ - (cos(rAJX_L)*sin(rAJZ_L) - cos(rAJZ_L)*sin(rAJX_L)*sin(rAJY_L))*(cos(rKJZ_L)*(sin(rBJY)*(cos(rHJZ_L)*sin(rHJX_L) - cos(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) + cos(rBJY)*sin(rBJZ)*(cos(rHJX_L)*cos(rHJZ_L) + sin(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) + cos(rBJY)*cos(rBJZ)*cos(rHJY_L)*sin(rHJZ_L)) - sin(rKJZ_L)*(sin(rBJY)*(sin(rHJX_L)*sin(rHJZ_L) + cos(rHJX_L)*cos(rHJZ_L)*sin(rHJY_L)) + cos(rBJY)*sin(rBJZ)*(cos(rHJX_L)*sin(rHJZ_L) - cos(rHJZ_L)*sin(rHJX_L)*sin(rHJY_L)) - cos(rBJY)*cos(rBJZ)*cos(rHJY_L)*cos(rHJZ_L))) - (sin(rAJX_L)*sin(rAJZ_L) + cos(rAJX_L)*cos(rAJZ_L)*sin(rAJY_L))*(cos(rBJY)*cos(rBJZ)*sin(rHJY_L) + cos(rHJX_L)*cos(rHJY_L)*sin(rBJY) - cos(rBJY)*cos(rHJY_L)*sin(rBJZ)*sin(rHJX_L)) - cos(rAJY_L)*cos(rAJZ_L)*(cos(rKJZ_L)*(sin(rBJY)*(sin(rHJX_L)*sin(rHJZ_L) + cos(rHJX_L)*cos(rHJZ_L)*sin(rHJY_L)) + cos(rBJY)*sin(rBJZ)*(cos(rHJX_L)*sin(rHJZ_L) - cos(rHJZ_L)*sin(rHJX_L)*sin(rHJY_L)) - cos(rBJY)*cos(rBJZ)*cos(rHJY_L)*cos(rHJZ_L)) + sin(rKJZ_L)*(sin(rBJY)*(cos(rHJZ_L)*sin(rHJX_L) - cos(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) + cos(rBJY)*sin(rBJZ)*(cos(rHJX_L)*cos(rHJZ_L) + sin(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) + cos(rBJY)*cos(rBJZ)*cos(rHJY_L)*sin(rHJZ_L))),   (sin(rAJX_L)*sin(rAJZ_L) + cos(rAJX_L)*cos(rAJZ_L)*sin(rAJY_L))*(sin(rHJY_L)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) + cos(rHJY_L)*sin(rHJX_L)*(cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ)) + cos(rBJY)*cos(rHJX_L)*cos(rHJY_L)*sin(rBJX)) + (cos(rAJX_L)*sin(rAJZ_L) - cos(rAJZ_L)*sin(rAJX_L)*sin(rAJY_L))*(cos(rKJZ_L)*(cos(rHJY_L)*sin(rHJZ_L)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) - (cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_L)*cos(rHJZ_L) + sin(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) + cos(rBJY)*sin(rBJX)*(cos(rHJZ_L)*sin(rHJX_L) - cos(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L))) + sin(rKJZ_L)*((cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_L)*sin(rHJZ_L) - cos(rHJZ_L)*sin(rHJX_L)*sin(rHJY_L)) + cos(rHJY_L)*cos(rHJZ_L)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) - cos(rBJY)*sin(rBJX)*(sin(rHJX_L)*sin(rHJZ_L) + cos(rHJX_L)*cos(rHJZ_L)*sin(rHJY_L)))) - cos(rAJY_L)*cos(rAJZ_L)*(cos(rKJZ_L)*((cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_L)*sin(rHJZ_L) - cos(rHJZ_L)*sin(rHJX_L)*sin(rHJY_L)) + cos(rHJY_L)*cos(rHJZ_L)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) - cos(rBJY)*sin(rBJX)*(sin(rHJX_L)*sin(rHJZ_L) + cos(rHJX_L)*cos(rHJZ_L)*sin(rHJY_L))) - sin(rKJZ_L)*(cos(rHJY_L)*sin(rHJZ_L)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) - (cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_L)*cos(rHJZ_L) + sin(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) + cos(rBJY)*sin(rBJX)*(cos(rHJZ_L)*sin(rHJX_L) - cos(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)))), cos(rAJY_L)*cos(rAJZ_L)*(sin(rKJZ_L)*((cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_L)*cos(rHJZ_L) + sin(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) + cos(rBJX)*cos(rBJY)*(cos(rHJZ_L)*sin(rHJX_L) - cos(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) - cos(rHJY_L)*sin(rHJZ_L)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY))) + cos(rKJZ_L)*((cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_L)*sin(rHJZ_L) - cos(rHJZ_L)*sin(rHJX_L)*sin(rHJY_L)) + cos(rHJY_L)*cos(rHJZ_L)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY)) + cos(rBJX)*cos(rBJY)*(sin(rHJX_L)*sin(rHJZ_L) + cos(rHJX_L)*cos(rHJZ_L)*sin(rHJY_L)))) - (sin(rAJX_L)*sin(rAJZ_L) + cos(rAJX_L)*cos(rAJZ_L)*sin(rAJY_L))*(sin(rHJY_L)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY)) + cos(rHJY_L)*sin(rHJX_L)*(cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ)) - cos(rBJX)*cos(rBJY)*cos(rHJX_L)*cos(rHJY_L)) - (sin(rKJZ_L)*((cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_L)*sin(rHJZ_L) - cos(rHJZ_L)*sin(rHJX_L)*sin(rHJY_L)) + cos(rHJY_L)*cos(rHJZ_L)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY)) + cos(rBJX)*cos(rBJY)*(sin(rHJX_L)*sin(rHJZ_L) + cos(rHJX_L)*cos(rHJZ_L)*sin(rHJY_L))) - cos(rKJZ_L)*((cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_L)*cos(rHJZ_L) + sin(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) + cos(rBJX)*cos(rBJY)*(cos(rHJZ_L)*sin(rHJX_L) - cos(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) - cos(rHJY_L)*sin(rHJZ_L)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY))))*(cos(rAJX_L)*sin(rAJZ_L) - cos(rAJZ_L)*sin(rAJX_L)*sin(rAJY_L));
       (cos(rAJX_L)*cos(rAJZ_L) + sin(rAJX_L)*sin(rAJY_L)*sin(rAJZ_L))*(cos(rKJZ_L)*(sin(rBJY)*(cos(rHJZ_L)*sin(rHJX_L) - cos(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) + cos(rBJY)*sin(rBJZ)*(cos(rHJX_L)*cos(rHJZ_L) + sin(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) + cos(rBJY)*cos(rBJZ)*cos(rHJY_L)*sin(rHJZ_L)) - sin(rKJZ_L)*(sin(rBJY)*(sin(rHJX_L)*sin(rHJZ_L) + cos(rHJX_L)*cos(rHJZ_L)*sin(rHJY_L)) + cos(rBJY)*sin(rBJZ)*(cos(rHJX_L)*sin(rHJZ_L) - cos(rHJZ_L)*sin(rHJX_L)*sin(rHJY_L)) - cos(rBJY)*cos(rBJZ)*cos(rHJY_L)*cos(rHJZ_L))) + (cos(rAJZ_L)*sin(rAJX_L) - cos(rAJX_L)*sin(rAJY_L)*sin(rAJZ_L))*(cos(rBJY)*cos(rBJZ)*sin(rHJY_L) + cos(rHJX_L)*cos(rHJY_L)*sin(rBJY) - cos(rBJY)*cos(rHJY_L)*sin(rBJZ)*sin(rHJX_L)) - cos(rAJY_L)*sin(rAJZ_L)*(cos(rKJZ_L)*(sin(rBJY)*(sin(rHJX_L)*sin(rHJZ_L) + cos(rHJX_L)*cos(rHJZ_L)*sin(rHJY_L)) + cos(rBJY)*sin(rBJZ)*(cos(rHJX_L)*sin(rHJZ_L) - cos(rHJZ_L)*sin(rHJX_L)*sin(rHJY_L)) - cos(rBJY)*cos(rBJZ)*cos(rHJY_L)*cos(rHJZ_L)) + sin(rKJZ_L)*(sin(rBJY)*(cos(rHJZ_L)*sin(rHJX_L) - cos(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) + cos(rBJY)*sin(rBJZ)*(cos(rHJX_L)*cos(rHJZ_L) + sin(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) + cos(rBJY)*cos(rBJZ)*cos(rHJY_L)*sin(rHJZ_L))), - (cos(rAJZ_L)*sin(rAJX_L) - cos(rAJX_L)*sin(rAJY_L)*sin(rAJZ_L))*(sin(rHJY_L)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) + cos(rHJY_L)*sin(rHJX_L)*(cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ)) + cos(rBJY)*cos(rHJX_L)*cos(rHJY_L)*sin(rBJX)) - (cos(rAJX_L)*cos(rAJZ_L) + sin(rAJX_L)*sin(rAJY_L)*sin(rAJZ_L))*(cos(rKJZ_L)*(cos(rHJY_L)*sin(rHJZ_L)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) - (cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_L)*cos(rHJZ_L) + sin(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) + cos(rBJY)*sin(rBJX)*(cos(rHJZ_L)*sin(rHJX_L) - cos(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L))) + sin(rKJZ_L)*((cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_L)*sin(rHJZ_L) - cos(rHJZ_L)*sin(rHJX_L)*sin(rHJY_L)) + cos(rHJY_L)*cos(rHJZ_L)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) - cos(rBJY)*sin(rBJX)*(sin(rHJX_L)*sin(rHJZ_L) + cos(rHJX_L)*cos(rHJZ_L)*sin(rHJY_L)))) - cos(rAJY_L)*sin(rAJZ_L)*(cos(rKJZ_L)*((cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_L)*sin(rHJZ_L) - cos(rHJZ_L)*sin(rHJX_L)*sin(rHJY_L)) + cos(rHJY_L)*cos(rHJZ_L)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) - cos(rBJY)*sin(rBJX)*(sin(rHJX_L)*sin(rHJZ_L) + cos(rHJX_L)*cos(rHJZ_L)*sin(rHJY_L))) - sin(rKJZ_L)*(cos(rHJY_L)*sin(rHJZ_L)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) - (cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_L)*cos(rHJZ_L) + sin(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) + cos(rBJY)*sin(rBJX)*(cos(rHJZ_L)*sin(rHJX_L) - cos(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)))), (sin(rKJZ_L)*((cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_L)*sin(rHJZ_L) - cos(rHJZ_L)*sin(rHJX_L)*sin(rHJY_L)) + cos(rHJY_L)*cos(rHJZ_L)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY)) + cos(rBJX)*cos(rBJY)*(sin(rHJX_L)*sin(rHJZ_L) + cos(rHJX_L)*cos(rHJZ_L)*sin(rHJY_L))) - cos(rKJZ_L)*((cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_L)*cos(rHJZ_L) + sin(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) + cos(rBJX)*cos(rBJY)*(cos(rHJZ_L)*sin(rHJX_L) - cos(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) - cos(rHJY_L)*sin(rHJZ_L)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY))))*(cos(rAJX_L)*cos(rAJZ_L) + sin(rAJX_L)*sin(rAJY_L)*sin(rAJZ_L)) + (cos(rAJZ_L)*sin(rAJX_L) - cos(rAJX_L)*sin(rAJY_L)*sin(rAJZ_L))*(sin(rHJY_L)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY)) + cos(rHJY_L)*sin(rHJX_L)*(cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ)) - cos(rBJX)*cos(rBJY)*cos(rHJX_L)*cos(rHJY_L)) + cos(rAJY_L)*sin(rAJZ_L)*(sin(rKJZ_L)*((cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_L)*cos(rHJZ_L) + sin(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) + cos(rBJX)*cos(rBJY)*(cos(rHJZ_L)*sin(rHJX_L) - cos(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) - cos(rHJY_L)*sin(rHJZ_L)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY))) + cos(rKJZ_L)*((cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_L)*sin(rHJZ_L) - cos(rHJZ_L)*sin(rHJX_L)*sin(rHJY_L)) + cos(rHJY_L)*cos(rHJZ_L)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY)) + cos(rBJX)*cos(rBJY)*(sin(rHJX_L)*sin(rHJZ_L) + cos(rHJX_L)*cos(rHJZ_L)*sin(rHJY_L))));
                                                                                                   sin(rAJY_L)*(cos(rKJZ_L)*(sin(rBJY)*(sin(rHJX_L)*sin(rHJZ_L) + cos(rHJX_L)*cos(rHJZ_L)*sin(rHJY_L)) + cos(rBJY)*sin(rBJZ)*(cos(rHJX_L)*sin(rHJZ_L) - cos(rHJZ_L)*sin(rHJX_L)*sin(rHJY_L)) - cos(rBJY)*cos(rBJZ)*cos(rHJY_L)*cos(rHJZ_L)) + sin(rKJZ_L)*(sin(rBJY)*(cos(rHJZ_L)*sin(rHJX_L) - cos(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) + cos(rBJY)*sin(rBJZ)*(cos(rHJX_L)*cos(rHJZ_L) + sin(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) + cos(rBJY)*cos(rBJZ)*cos(rHJY_L)*sin(rHJZ_L))) - cos(rAJX_L)*cos(rAJY_L)*(cos(rBJY)*cos(rBJZ)*sin(rHJY_L) + cos(rHJX_L)*cos(rHJY_L)*sin(rBJY) - cos(rBJY)*cos(rHJY_L)*sin(rBJZ)*sin(rHJX_L)) + cos(rAJY_L)*sin(rAJX_L)*(cos(rKJZ_L)*(sin(rBJY)*(cos(rHJZ_L)*sin(rHJX_L) - cos(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) + cos(rBJY)*sin(rBJZ)*(cos(rHJX_L)*cos(rHJZ_L) + sin(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) + cos(rBJY)*cos(rBJZ)*cos(rHJY_L)*sin(rHJZ_L)) - sin(rKJZ_L)*(sin(rBJY)*(sin(rHJX_L)*sin(rHJZ_L) + cos(rHJX_L)*cos(rHJZ_L)*sin(rHJY_L)) + cos(rBJY)*sin(rBJZ)*(cos(rHJX_L)*sin(rHJZ_L) - cos(rHJZ_L)*sin(rHJX_L)*sin(rHJY_L)) - cos(rBJY)*cos(rBJZ)*cos(rHJY_L)*cos(rHJZ_L))),                                                                                               sin(rAJY_L)*(cos(rKJZ_L)*((cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_L)*sin(rHJZ_L) - cos(rHJZ_L)*sin(rHJX_L)*sin(rHJY_L)) + cos(rHJY_L)*cos(rHJZ_L)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) - cos(rBJY)*sin(rBJX)*(sin(rHJX_L)*sin(rHJZ_L) + cos(rHJX_L)*cos(rHJZ_L)*sin(rHJY_L))) - sin(rKJZ_L)*(cos(rHJY_L)*sin(rHJZ_L)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) - (cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_L)*cos(rHJZ_L) + sin(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) + cos(rBJY)*sin(rBJX)*(cos(rHJZ_L)*sin(rHJX_L) - cos(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)))) + cos(rAJX_L)*cos(rAJY_L)*(sin(rHJY_L)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) + cos(rHJY_L)*sin(rHJX_L)*(cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ)) + cos(rBJY)*cos(rHJX_L)*cos(rHJY_L)*sin(rBJX)) - cos(rAJY_L)*sin(rAJX_L)*(cos(rKJZ_L)*(cos(rHJY_L)*sin(rHJZ_L)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) - (cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_L)*cos(rHJZ_L) + sin(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) + cos(rBJY)*sin(rBJX)*(cos(rHJZ_L)*sin(rHJX_L) - cos(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L))) + sin(rKJZ_L)*((cos(rBJX)*cos(rBJZ) + sin(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_L)*sin(rHJZ_L) - cos(rHJZ_L)*sin(rHJX_L)*sin(rHJY_L)) + cos(rHJY_L)*cos(rHJZ_L)*(cos(rBJX)*sin(rBJZ) - cos(rBJZ)*sin(rBJX)*sin(rBJY)) - cos(rBJY)*sin(rBJX)*(sin(rHJX_L)*sin(rHJZ_L) + cos(rHJX_L)*cos(rHJZ_L)*sin(rHJY_L)))),                                                                                             cos(rAJY_L)*sin(rAJX_L)*(sin(rKJZ_L)*((cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_L)*sin(rHJZ_L) - cos(rHJZ_L)*sin(rHJX_L)*sin(rHJY_L)) + cos(rHJY_L)*cos(rHJZ_L)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY)) + cos(rBJX)*cos(rBJY)*(sin(rHJX_L)*sin(rHJZ_L) + cos(rHJX_L)*cos(rHJZ_L)*sin(rHJY_L))) - cos(rKJZ_L)*((cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_L)*cos(rHJZ_L) + sin(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) + cos(rBJX)*cos(rBJY)*(cos(rHJZ_L)*sin(rHJX_L) - cos(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) - cos(rHJY_L)*sin(rHJZ_L)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY)))) - cos(rAJX_L)*cos(rAJY_L)*(sin(rHJY_L)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY)) + cos(rHJY_L)*sin(rHJX_L)*(cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ)) - cos(rBJX)*cos(rBJY)*cos(rHJX_L)*cos(rHJY_L)) - sin(rAJY_L)*(sin(rKJZ_L)*((cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_L)*cos(rHJZ_L) + sin(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) + cos(rBJX)*cos(rBJY)*(cos(rHJZ_L)*sin(rHJX_L) - cos(rHJX_L)*sin(rHJY_L)*sin(rHJZ_L)) - cos(rHJY_L)*sin(rHJZ_L)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY))) + cos(rKJZ_L)*((cos(rBJZ)*sin(rBJX) - cos(rBJX)*sin(rBJY)*sin(rBJZ))*(cos(rHJX_L)*sin(rHJZ_L) - cos(rHJZ_L)*sin(rHJX_L)*sin(rHJY_L)) + cos(rHJY_L)*cos(rHJZ_L)*(sin(rBJX)*sin(rBJZ) + cos(rBJX)*cos(rBJZ)*sin(rBJY)) + cos(rBJX)*cos(rBJY)*(sin(rHJX_L)*sin(rHJZ_L) + cos(rHJX_L)*cos(rHJZ_L)*sin(rHJY_L))))];
   
    R_0footR=inv(R_footR0);
    R_0footL=inv(R_footL0);
    
    centerR=[force.copX_R(2*k); force.copY_R(2*k); force.copZ_R(2*k)];
    centerL=[force.copX_L(2*k); force.copY_L(2*k); force.copZ_L(2*k)];
    
    pos_AJL=[motion.jointX.smoothed(12,k); motion.jointY.smoothed(12,k); motion.jointZ.smoothed(12,k)];
    pos_AJR=[motion.jointX.smoothed(13,k); motion.jointY.smoothed(13,k); motion.jointZ.smoothed(13,k)];

    CPR(:,k)=R_0footR*(centerR-pos_AJR);
    CPL(:,k)=R_0footL*(centerL-pos_AJL);
    
end

clear q R_footR0 R_footL0 R_0footR R_0footL centerR centerL pos_AJL pos_AJR pBJX pBJY pBJZ rBJX rBJY rBJZ rLNJX rLNJY rLNJZ rSJX_L rSJY_L rSJZ_L rSJX_R rSJY_R rSJZ_R rEJZ_L rEJZ_R rULJX rULJY rULJZ rLLJX rLLJZ rHJX_L rHJY_L rHJZ_L rHJX_R rHJY_R rHJZ_R rKJZ_L rKJZ_R rAJX_L rAJY_L rAJZ_L rAJX_R rAJY_R rAJZ_R